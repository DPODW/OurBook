<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ourbook.shop.mapper.MemberMapper">
    <insert id="commonInsert">
        <choose>
            <when test="commonRole == 'BUYER'">
                insert into buyer_tb(name,id,pwd,email,role)
                values(#{commonName},#{commonId},#{commonPwd},#{commonEmail},#{commonRole});
            </when>
            <otherwise>
                insert into seller_tb(name,id,pwd,email,role)
                values(#{commonName},#{commonId},#{commonPwd},#{commonEmail},#{commonRole});
            </otherwise>
        </choose>
    </insert>
    <insert id="naverInsert">
        insert into buyer_tb(name,id,pwd,email,role)
        values(#{name},#{id},#{pwd},#{email},#{role});
    </insert>



    <update id="commonUpdate" parameterType="com.ourbook.shop.dto.CommonMember">
        <choose>
            <when test="commonRole == 'BUYER'">
                update buyer_tb
                set name = #{commonName} , pwd = #{commonPwd} , email = #{commonEmail} , role = #{commonRole}
                where id = #{commonId};
            </when>
            <otherwise>
                update seller_tb
                set name = #{commonName} , pwd = #{commonPwd} , email = #{commonEmail} , role = #{commonRole}
                where id = #{commonId};
            </otherwise>
        </choose>
    </update>



<!--DELETE 에서의 role 은 userDetail 에서 가져온거라서, "[권한]" 형식으로 받음.userDetail-->
    <delete id="commonDelete" parameterType="String">
        <choose>
            <when test="role == '[BUYER]'">
                DELETE FROM buyer_tb WHERE id = #{deleteValue}
            </when>
            <otherwise>
                DELETE FROM seller_tb WHERE id = #{deleteValue}
            </otherwise>
        </choose>
    </delete>
    <delete id="naverDelete" parameterType="String">
        DELETE FROM buyer_tb WHERE email = #{email}
    </delete>
</mapper>